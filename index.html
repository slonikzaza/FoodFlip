<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <title>FoodFlip</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Montserrat', sans-serif;
      margin: 0;
      padding: 20px;
      background: #f0f2f5;
      color: #333;
    }
    h2, h3, h4 {
      color: #222;
      margin-top: 0;
    }
    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 12px 0;
      margin: 8px 6px;
      width: 140px;
      height: 48px;
      border: none;
      border-radius: 24px;
      background: linear-gradient(135deg, #6DD5FA, #2980B9);
      color: white;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: opacity 0.3s ease, transform 0.2s ease;
    }
    .btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    .btn:hover:not(:disabled) {
      transform: translateY(-2px);
    }
    .btn-danger {
      background: linear-gradient(135deg, #EB5757, #BB2D3B);
      width: 120px;
      font-size: 14px;
    }
    .section {
      display: none;
      margin-top: 20px;
    }
    .modal-overlay {
      position: fixed;
      top: 0; left: 0;
      width: 100vw; height: 100vh;
      background: rgba(0,0,0,0.5);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }
    .modal {
      background: #fff;
      padding: 20px;
      border-radius: 16px;
      width: 90%;
      max-width: 400px;
      text-align: center;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }
    .modal img {
      width: 160px;
      height: 160px;
      object-fit: cover;
      border-radius: 12px;
      margin-bottom: 12px;
    }
    .item {
      background: #fff;
      padding: 14px;
      margin: 10px 0;
      border-radius: 16px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 4px 8px rgba(0,0,0,0.05);
    }
    .item img {
      width: 60px;
      height: 60px;
      object-fit: cover;
      border-radius: 10px;
      margin-right: 15px;
    }
    .item-info {
      display: flex;
      align-items: center;
    }
    .item-details {
      line-height: 1.3;
    }
    .disabled {
      opacity: 0.5;
      text-decoration: line-through;
    }
    .navigation-buttons {
      margin-top: 20px;
      text-align: right;
    }
    .filters label {
      margin-right: 20px;
      font-size: 14px;
    }
    .filters input {
      width: 60px;
      margin-left: 6px;
      padding: 4px;
      border-radius: 4px;
      border: 1px solid #ccc;
      font-size: 14px;
    }
  </style>
</head>
<body>
  <h2>–í–∏–±–µ—Ä–∏ —Ä–æ–∑–¥—ñ–ª –º–µ–Ω—é:</h2>
  <button class="btn" onclick="selectCategory('burgers')">üçî –ë—É—Ä–≥–µ—Ä–∏ —Ç–∞ —Ä–æ–ª–∏</button>
  <button class="btn" onclick="selectCategory('chicken')">üçó –ö—É—Ä–∫–∞</button>
  <button class="btn" onclick="selectCategory('fries')">üçü –ö–∞—Ä—Ç–æ–ø–ª—è/–ö–∞—à–∞/–°–∞–ª–∞—Ç–∏</button>
  <button class="btn" onclick="selectCategory('drinks')">ü•§ –ù–∞–ø–æ—ó</button>
  <button class="btn" onclick="selectCategory('coffee')">‚òï –ö–∞–≤–∞</button>
  <button class="btn" onclick="selectCategory('desserts')">üç∞ –î–µ—Å–µ—Ä—Ç–∏</button>
  <button class="btn" onclick="selectCategory('happyMeal')">üßÉ –•–µ–ø–ø—ñ –ú—ñ–ª</button>
  <button class="btn" onclick="selectCategory('breakfast')">üç≥ –°–Ω—ñ–¥–∞–Ω–æ–∫</button>

  <!-- –ú–µ–Ω—é –æ–±—Ä–∞–Ω–æ–≥–æ —Ä–æ–∑–¥—ñ–ª—É -->
  <div id="menuSection" class="section">
    <h3>–†–æ–∑–¥—ñ–ª: <span id="categoryName"></span></h3>
    <div class="filters">
      <label>–ú–∞–∫—Å. –∫–∞–ª–æ—Ä—ñ—ó:<input type="number" id="calorieFilter" value="1000"></label>
      <label>–ú–∞–∫—Å. —Ü—ñ–Ω–∞ (‚Ç¥): <input type="number" id="priceFilter" value="1000"></label>
      <button class="btn" onclick="filterAndPick()">üé≤ –†–∞–Ω–¥–æ–º</button>
    </div>
    <div id="dishList"></div>
  </div>

  <!-- –ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –¥–ª—è –≤–∏–±—Ä–∞–Ω–æ—ó —Å—Ç—Ä–∞–≤–∏ -->
  <div id="dishModalOverlay" class="modal-overlay">
    <div class="modal" id="dishModal">
      <img id="modalDishImg" src="" alt="Dish Image">
      <h3 id="modalDishName"></h3>
      <div class="navigation-buttons">
        <button class="btn" onclick="chooseOnlyDish()">–¢—ñ–ª—å–∫–∏ —Å—Ç—Ä–∞–≤—É</button>
        <!-- –Ø–∫—â–æ —É —Å—Ç—Ä–∞–≤–∏ —î –¥–æ–¥–∞—Ç–∫–æ–≤–µ –º–µ–Ω—é (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —É –±—É—Ä–≥–µ—Ä—ñ–≤), –ø–æ–∫–∞–∑—É–≤–∞—Ç–∏ –∫–Ω–æ–ø–∫—É "–í–∏–±—Ä–∞—Ç–∏ –º–µ–Ω—é" -->
        <button class="btn" id="modalMenuBtn" style="display: none;" onclick="chooseMenu()">–í–∏–±—Ä–∞—Ç–∏ –º–µ–Ω—é</button>
        <button class="btn" onclick="pickAnotherDish()">–Ü–Ω—à–µ (—Ä–∞–Ω–¥–æ–º–Ω–æ)</button>
      </div>
      <div style="margin-top:10px;">
        <button id="modalExcludeBtn" class="btn-danger" onclick="excludeCurrentDish()">–í–∏–∫–ª—é—á–∏—Ç–∏ –∑ —Ä–∞–Ω–¥–æ–º–∞</button>
      </div>
    </div>
  </div>

  <!-- –°–µ–∫—Ü—ñ—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –º–µ–Ω—é (—Ç—ñ–ª—å–∫–∏ –¥–ª—è –±—É—Ä–≥–µ—Ä—ñ–≤) -->
  <div id="menuBuilderSection" class="section">
    <h3>–°—Ç–≤–æ—Ä–∏—Ç–∏ –º–µ–Ω—é McDonald's</h3>

    <!-- –í–∫–ª–∞–¥–∫–∏: 1. –ë–ª—é–¥–æ, 2. –°–æ—É—Å–∏, 3. –ù–∞–ø–æ—ó -->
    <div id="dishesTab" class="tab active">
      <h4>1. –û–±–µ—Ä—ñ—Ç—å —Å—Ç—Ä–∞–≤—É (–∑ —Ç—Ä—å–æ—Ö):</h4>
      <div id="firstChoices"></div>
      <div class="navigation-buttons">
        <button id="randomDishBtn" class="btn" onclick="randomizeBuilderDish()">üé≤ –†–∞–Ω–¥–æ–º –±–ª—é–¥–æ</button>
        <button id="toSaucesBtn" class="btn" onclick="toSauces()" disabled>–î–∞–ª—ñ: –°–æ—É—Å–∏</button>
      </div>
    </div>

    <div id="saucesTab" class="tab">
      <h4>2. –û–±–µ—Ä—ñ—Ç—å —Å–æ—É—Å:</h4>
      <div id="saucesList"></div>
      <div class="navigation-buttons">
        <button class="btn" onclick="backToDishes()">–ù–∞–∑–∞–¥</button>
        <button id="randomSauceBtn" class="btn" onclick="randomizeBuilderSauce()">üé≤ –†–∞–Ω–¥–æ–º —Å–æ—É—Å</button>
        <button id="toDrinksBtn" class="btn" onclick="toDrinks()" disabled>–î–∞–ª—ñ: –ù–∞–ø–æ—ó</button>
      </div>
    </div>

    <div id="drinksTab" class="tab">
      <h4>3. –û–±–µ—Ä—ñ—Ç—å –Ω–∞–ø—ñ–π:</h4>
      <div id="drinksList"></div>
      <div class="navigation-buttons">
        <button class="btn" onclick="backToSauces()">–ù–∞–∑–∞–¥</button>
        <button id="randomDrinkBtn" class="btn" onclick="randomizeBuilderDrink()">üé≤ –†–∞–Ω–¥–æ–º –Ω–∞–ø—ñ–π</button>
        <button id="finishMenuBtn" class="btn" onclick="finishMenu()" disabled>–ó–∞–≤–µ—Ä—à–∏—Ç–∏ –º–µ–Ω—é</button>
      </div>
    </div>
  </div>

  <script>
    Telegram.WebApp.ready();

    // === –î–ê–ù–Ü: –†–û–ó–î–Ü–õ–ò –¢–ê –°–¢–†–ê–í–ò ===
    // –î–ª—è –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó "burgers" –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ –≥–æ—Ç–æ–≤–∏–π –º–∞—Å–∏–≤ —ñ–∑ –∫–æ–¥–æ–º –±—É—Ä–≥–µ—Ä—ñ–≤. –Ü–Ω—à—ñ —Ä–æ–∑–¥—ñ–ª–∏ –º–æ–∂–Ω–∞ –¥–æ–ø–æ–≤–Ω–∏—Ç–∏ –¥–∞–Ω–∏–º–∏ –∞–Ω–∞–ª–æ–≥—ñ—á–Ω–æ.
    const menuCategories = {
      burgers: [
        { name: "–ë—ñ–≥ –ú–∞–∫¬Æ", calories: 526, price: 141, img: "https://d3tqkqn8yl74v5.cloudfront.net/TPO-chf_ua_3413_BigMac.png", hasMenu: true },
        { name: "–ë—ñ–≥ –¢–µ–π—Å—Ç—ñ –°–∏–Ω–≥–ª", calories: 620, price: 192, img: "https://d3tqkqn8yl74v5.cloudfront.net/TPO-chf_3442_Sdwch_Big_Tasty_Single.jpg", hasMenu: true },
        { name: "–¢–µ–π—Å—Ç—ñ –î–∂—É–Ω—ñ–æ—Ä", calories: 400, price: 104, img: "https://d3tqkqn8yl74v5.cloudfront.net/TPO-chf_3441_Sdwch_Big_Tasty_Junior.jpg", hasMenu: true },
        { name: "–î–∞–±–ª –ë—ñ–≥ –¢–µ–π—Å—Ç—ñ", calories: 880, price: 271, img: "https://d3tqkqn8yl74v5.cloudfront.net/TPO-chf_3443_Sdwch_Big_Tasty_Double.jpg", hasMenu: true },
        { name: "–î–∞–±–ª –†–æ—è–ª –ß—ñ–∑–±—É—Ä–≥–µ—Ä", calories: 760, price: 240, img: "https://d3tqkqn8yl74v5.cloudfront.net/TPO-chf_ua_3415_DoubleRoyalCheeseburger_2.png", hasMenu: true },
        { name: "–†–æ—è–ª –ß—ñ–∑–±—É—Ä–≥–µ—Ä", calories: 530, price: 161, img: "https://d3tqkqn8yl74v5.cloudfront.net/TPO-chf_ua_3414_RoyalCheeseburger_2.png", hasMenu: true },
        { name: "–ú–∞–∫–ß—ñ–∫–µ–Ω", calories: 448, price: 119, img: "https://d3tqkqn8yl74v5.cloudfront.net/TPO-chf_ua_3416_McChicken.png", hasMenu: true },
        { name: "–§—ñ–ª–µ-–æ-–§—ñ—à", calories: 379, price: 117, img: "https://d3tqkqn8yl74v5.cloudfront.net/TPO-chf_ua_3412_File-o-Fish_2025.png", hasMenu: true },
        { name: "–î–∞–±–ª –ß—ñ–∑–±—É—Ä–≥–µ—Ä", calories: 475, price: 121, img: "https://d3tqkqn8yl74v5.cloudfront.net/TPO-chf_ua_3411_DoubleCheeseburger.png", hasMenu: true },
        { name: "–ß—ñ–∑–±—É—Ä–≥–µ—Ä", calories: 298, price: 73, img: "https://d3tqkqn8yl74v5.cloudfront.net/TPO-chf_ua_3409_Cheeseburger.png", hasMenu: true },
        { name: "–ì–∞–º–±—É—Ä–≥–µ—Ä", calories: 249, price: 63, img: "https://d3tqkqn8yl74v5.cloudfront.net/TPO-chf_ua_3408_Hamburger.png", hasMenu: true },
        { name: "–ß—ñ–∫–µ–Ω –ú–∞–∫–ù–∞–≥–µ—Ç—Å 6—à—Ç", calories: 265, price: 101, img: "https://d3tqkqn8yl74v5.cloudfront.net/TPO-chf_ua_2130_Nuggets_6.png", hasMenu: true },
        { name: "–ß—ñ–∫–µ–Ω –ú–∞–∫–ù–∞–≥–µ—Ç—Å 9—à—Ç", calories: 398, price: 145, img: "https://d3tqkqn8yl74v5.cloudfront.net/TPO-chf_ua_2131_Nuggets_9.png", hasMenu: true },
        { name: "–ß—ñ–∫–µ–Ω –î–∂—É–Ω—ñ–æ—Ä", calories: 330, price: 73, img: "https://d3tqkqn8yl74v5.cloudfront.net/TPO-chf_ua_3426_CHICKEN_JUNIOR_BEST.png", hasMenu: true },
        { name: "–ö—É—Ä—è—á—ñ —Å—Ç—Ä—ñ–ø—Å–∏ 3—à—Ç", calories: 200, price: 97, img: "https://d3tqkqn8yl74v5.cloudfront.net/TPO-chf_ua_3500_3strips.png", hasMenu: true }
      ],
      chicken: [
        // –¢–æ—á–Ω–æ —Ç—ñ —Å–∞–º—ñ "–ß—ñ–∫–µ–Ω –ú–∞–∫–ù–∞–≥–µ—Ç—Å", "–ß—ñ–∫–µ–Ω –î–∂—É–Ω—ñ–æ—Ä" —Ç–∞ "–ö—É—Ä—è—á—ñ —Å—Ç—Ä—ñ–ø—Å–∏" –≤–∂–µ —î –≤ —Ä–æ–∑–¥—ñ–ª—ñ burgers –∑ hasMenu: true.
        // –í–∏ –º–æ–∂–µ—Ç–µ –¥—É–±–ª—é–≤–∞—Ç–∏ —ó—Ö –∞–±–æ –≤–∫–∞–∑–∞—Ç–∏ –æ–∫—Ä–µ–º–æ:
        { name: "–ß—ñ–∫–µ–Ω –ú–∞–∫–ù–∞–≥–µ—Ç—Å 6—à—Ç", calories: 265, price: 101, img: "https://d3tqkqn8yl74v5.cloudfront.net/TPO-chf_ua_2130_Nuggets_6.png", hasMenu: false },
        { name: "–ß—ñ–∫–µ–Ω –ú–∞–∫–ù–∞–≥–µ—Ç—Å 9—à—Ç", calories: 398, price: 145, img: "https://d3tqkqn8yl74v5.cloudfront.net/TPO-chf_ua_2131_Nuggets_9.png", hasMenu: false },
        { name: "–ß—ñ–∫–µ–Ω –î–∂—É–Ω—ñ–æ—Ä", calories: 330, price: 73, img: "https://d3tqkqn8yl74v5.cloudfront.net/TPO-chf_ua_3426_CHICKEN_JUNIOR_BEST.png", hasMenu: false },
        { name: "–ö—É—Ä—è—á—ñ —Å—Ç—Ä—ñ–ø—Å–∏ 3—à—Ç", calories: 200, price: 97, img: "https://d3tqkqn8yl74v5.cloudfront.net/TPO-chf_ua_3500_3strips.png", hasMenu: false }
      ],
      fries: [
        { name: "–ö–∞—Ä—Ç–æ–ø–ª—è –§—Ä—ñ", calories: 312, price: 55, img: "https://via.placeholder.com/60", hasMenu: false },
        { name: "–ö–∞—Ä—Ç–æ–ø–ª—è –ø–æ-—Å–µ–ª—è–Ω—Å—å–∫–∏", calories: 340, price: 65, img: "https://via.placeholder.com/60", hasMenu: false },
        { name: "–°–∞–ª–∞—Ç –¶–µ–∑–∞—Ä", calories: 180, price: 75, img: "https://via.placeholder.com/60", hasMenu: false },
        { name: "–ö–∞—à–∞", calories: 150, price: 45, img: "https://via.placeholder.com/60", hasMenu: false }
      ],
      drinks: [
        { name: "Coca-Cola", calories: 140, price: 45, img: "https://i.imgur.com/UyjY9v2.png", hasMenu: false },
        { name: "Fanta", calories: 160, price: 45, img: "https://i.imgur.com/PQXtJQx.png", hasMenu: false },
        { name: "Sprite", calories: 150, price: 45, img: "https://i.imgur.com/JkKz0Wb.png", hasMenu: false },
        { name: "–°—ñ–∫ –ê–ø–µ–ª—å—Å–∏–Ω–æ–≤–∏–π", calories: 110, price: 50, img: "https://via.placeholder.com/60", hasMenu: false },
        { name: "–í–æ–¥–∞", calories: 0, price: 30, img: "https://i.imgur.com/7sA5C2x.png", hasMenu: false }
      ],
      coffee: [
        { name: "–ï—Å–ø—Ä–µ—Å–æ", calories: 5, price: 40, img: "https://via.placeholder.com/60", hasMenu: false },
        { name: "–ê–º–µ—Ä–∏–∫–∞–Ω–æ", calories: 10, price: 45, img: "https://via.placeholder.com/60", hasMenu: false },
        { name: "–ö–∞–ø—É—á–∏–Ω–æ", calories: 120, price: 60, img: "https://via.placeholder.com/60", hasMenu: false },
        { name: "–õ–∞—Ç–µ", calories: 150, price: 65, img: "https://via.placeholder.com/60", hasMenu: false },
        { name: "–ê–º–µ—Ä–∏–∫–∞–Ω–æ –§—Ä–µ—à", calories: 15, price: 50, img: "https://via.placeholder.com/60", hasMenu: false }
      ],
      desserts: [
        { name: "–ú–∞–∫–§–ª—É—Ä—ñ", calories: 230, price: 55, img: "https://via.placeholder.com/60", hasMenu: false },
        { name: "–ú–∞–∫–ü–∏—Ä—ñ–≥¬Æ –ü–æ–ª—É–Ω–∏—Ü—è", calories: 280, price: 50, img: "https://via.placeholder.com/60", hasMenu: false },
        { name: "–ú–æ—Ä–æ–∑–∏–≤–æ –í–∞–Ω—ñ–ª—å–Ω–µ", calories: 200, price: 45, img: "https://via.placeholder.com/60", hasMenu: false },
        { name: "–®–æ–∫–æ–ª–∞–¥–Ω–∏–π –ú–∞—Ñ—Ñ—ñ–Ω", calories: 330, price: 65, img: "https://via.placeholder.com/60", hasMenu: false }
      ],
      happyMeal: [
        { name: "–•–µ–ø–ø—ñ –ú—ñ–ª –∑ –Ω–∞–≥–µ—Ç—Å–∞–º–∏", calories: 500, price: 160, img: "https://via.placeholder.com/60", hasMenu: false },
        { name: "–•–µ–ø–ø—ñ –ú—ñ–ª –∑ –±—É—Ä–≥–µ—Ä–æ–º", calories: 550, price: 170, img: "https://via.placeholder.com/60", hasMenu: false }
      ],
      breakfast: [
        { name: "–ú–∞–∫–ú–∞—Ñ—ñ–Ω –∑ —è–π—Ü–µ–º —Ç–∞ —Å–∏—Ä–æ–º", calories: 300, price: 75, img: "https://via.placeholder.com/60", hasMenu: false },
        { name: "–ú–∞–∫–ú–∞—Ñ—ñ–Ω –∑ —è–π—Ü–µ–º —Ç–∞ –±–µ–∫–æ–Ω–æ–º", calories: 350, price: 85, img: "https://via.placeholder.com/60", hasMenu: false },
        { name: "–ú–∞–∫–ú–∞—Ñ—ñ–Ω –§—Ä–µ—à", calories: 320, price: 90, img: "https://via.placeholder.com/60", hasMenu: false },
        { name: "–¢–æ—Å—Ç –∑ —Å–∏—Ä–æ–º —Ç–∞ –±–µ–∫–æ–Ω–æ–º", calories: 360, price: 80, img: "https://via.placeholder.com/60", hasMenu: false },
        { name: "–ö–∞—à–∞", calories: 150, price: 45, img: "https://via.placeholder.com/60", hasMenu: false }
      ]
    };

    const sauces = [
      { name: "–ö–µ—Ç—á—É–ø" },
      { name: "–ì–∞—Ä–±—É–∑–æ–≤–∏–π —Å–æ—É—Å" },
      { name: "–°–∏—Ä–Ω–∏–π —Å–æ—É—Å" },
      { name: "–ß–∞—Å–Ω–∏–∫–æ–≤–∏–π —Å–æ—É—Å" },
      { name: "–ß–∏–ª—ñ —Å–æ—É—Å" }
    ];

    const drinksForBuilder = [
      { name: "Coca-Cola", img: "https://i.imgur.com/UyjY9v2.png" },
      { name: "Fanta", img: "https://i.imgur.com/PQXtJQx.png" },
      { name: "Sprite", img: "https://i.imgur.com/JkKz0Wb.png" },
      { name: "–í–æ–¥–∞", img: "https://i.imgur.com/7sA5C2x.png" },
      { name: "–ß–∞–π —Ö–æ–ª–æ–¥–Ω–∏–π", img: "https://i.imgur.com/VBoXu3q.png" }
    ];

    // –î–ª—è –º–µ–Ω—é-–±—ñ–ª–¥–µ—Ä–∞ (—Ç—ñ–ª—å–∫–∏ ¬´–±—É—Ä–≥–µ—Ä—ñ–≤¬ª) –º–∏ –±–µ—Ä–µ–º–æ —Ç—Ä–∏ –≤–∞—Ä—ñ–∞–Ω—Ç–∏:
    const firstChoices = [
      { name: "–ö–∞—Ä—Ç–æ–ø–ª—è —Ñ—Ä—ñ", img: "https://i.imgur.com/3pZe5kq.png" },
      { name: "–î—ñ–ø–∏",       img: "https://i.imgur.com/Cl8vQTo.png" },
      { name: "–°–∞–ª–∞—Ç",      img: "https://i.imgur.com/ODQ6oTs.png" }
    ];

    // === –°–¢–ê–ù ===
    let selectedCategory = '';
    let excludedDishes = new Set();
    let currentPickedDish = null;

    let builderSelection = {
      dish: null,
      sauce: null,
      drink: null,
      excludedBuilderDishes: new Set()
    };

    // === –§–£–ù–ö–¶–Ü–á ===

    // –í–∏–±—ñ—Ä —Ä–æ–∑–¥—ñ–ª—É –º–µ–Ω—é
    function selectCategory(category) {
      selectedCategory = category;
      document.getElementById("menuSection").style.display = "block";
      document.getElementById("menuBuilderSection").style.display = "none";
      document.getElementById("categoryName").textContent = getCategoryLabel(category);
      excludedDishes.clear();
      renderMenu();
    }

    function getCategoryLabel(cat) {
      switch(cat) {
        case 'burgers': return "–ë—É—Ä–≥–µ—Ä–∏ —Ç–∞ —Ä–æ–ª–∏";
        case 'chicken': return "–ö—É—Ä–∫–∞";
        case 'fries': return "–ö–∞—Ä—Ç–æ–ø–ª—è/–ö–∞—à–∞/–°–∞–ª–∞—Ç–∏";
        case 'drinks': return "–ù–∞–ø–æ—ó";
        case 'coffee': return "–ö–∞–≤–∞";
        case 'desserts': return "–î–µ—Å–µ—Ä—Ç–∏";
        case 'happyMeal': return "–•–µ–ø–ø—ñ –ú—ñ–ª";
        case 'breakfast': return "–°–Ω—ñ–¥–∞–Ω–æ–∫";
        default: return "";
      }
    }

    // –í—ñ–¥–æ–±—Ä–∞–∑–∏—Ç–∏ —Å–ø–∏—Å–æ–∫ —Å—Ç—Ä–∞–≤ –æ–±—Ä–∞–Ω–æ–≥–æ —Ä–æ–∑–¥—ñ–ª—É
    function renderMenu() {
      const container = document.getElementById("dishList");
      container.innerHTML = '';
      const list = menuCategories[selectedCategory] || [];
      list.forEach(dish => {
        const isExcluded = excludedDishes.has(dish.name);
        const div = document.createElement("div");
        div.className = "item" + (isExcluded ? " disabled" : "");
        const imgSrc = dish.img || "https://via.placeholder.com/60";
        div.innerHTML = `
          <div class="item-info">
            <img src="${imgSrc}" alt="${dish.name}">
            <div class="item-details">
              <strong>${dish.name}</strong><br>
              ${dish.calories} –∫–∫–∞–ª ‚Äî ‚Ç¥${dish.price.toFixed(2)}
            </div>
          </div>
          <div>
            <button class="btn" onclick="pickThisDish('${dish.name}')" ${isExcluded ? 'disabled' : ''}>
              –í–∏–±—Ä–∞—Ç–∏
            </button>
            <button class="btn-danger" onclick="toggleDish('${dish.name}')">
              ${isExcluded ? "–í–∫–ª—é—á–∏—Ç–∏" : "–í–∏–∫–ª—é—á–∏—Ç–∏"}
            </button>
          </div>
        `;
        container.appendChild(div);
      });
    }

    // –í–∏–∫–ª—é—á–∏—Ç–∏/–≤–∫–ª—é—á–∏—Ç–∏ —Å—Ç—Ä–∞–≤—É –∑ —Ä–∞–Ω–¥–æ–º–∞
    function toggleDish(name) {
      if (excludedDishes.has(name)) {
        excludedDishes.delete(name);
      } else {
        excludedDishes.add(name);
      }
      renderMenu();
    }

    // –í–∏–±—Ä–∞—Ç–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É —Å—Ç—Ä–∞–≤—É —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É ¬´–í–∏–±—Ä–∞—Ç–∏¬ª
    function pickThisDish(name) {
      const list = menuCategories[selectedCategory] || [];
      const dish = list.find(d => d.name === name);
      if (!dish) return;
      showDishModal(dish);
    }

    // –§—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏ –∑–∞ –∫–∞–ª–æ—Ä—ñ—è–º–∏ —Ç–∞ —Ü—ñ–Ω–æ—é —ñ –≤–∏–ø–∞–¥–∫–æ–≤–∏–º —á–∏–Ω–æ–º –≤–∏–±—Ä–∞—Ç–∏
    function filterAndPick() {
      const maxCalories = parseInt(document.getElementById("calorieFilter").value) || Infinity;
      const maxPrice = parseFloat(document.getElementById("priceFilter").value) || Infinity;
      const list = menuCategories[selectedCategory] || [];
      const filtered = list.filter(d =>
        d.calories <= maxCalories &&
        d.price <= maxPrice &&
        !excludedDishes.has(d.name)
      );
      if (filtered.length === 0) {
        alert("–ù–µ–º–∞—î –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏—Ö —Å—Ç—Ä–∞–≤ üòï");
        return;
      }
      const pick = filtered[Math.floor(Math.random() * filtered.length)];
      showDishModal(pick);
    }

    // –ü–æ–∫–∞–∑–∞—Ç–∏ –º–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –∑ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—î—é –ø—Ä–æ —Å—Ç—Ä–∞–≤—É
    function showDishModal(dish) {
      currentPickedDish = dish;
      const imgSrc = dish.img || "https://via.placeholder.com/160";
      document.getElementById("modalDishImg").src = imgSrc;
      document.getElementById("modalDishName").textContent = dish.name;
      document.getElementById("modalExcludeBtn").textContent =
        excludedDishes.has(dish.name) ? "–í–∫–ª—é—á–∏—Ç–∏ –∑ —Ä–∞–Ω–¥–æ–º–∞" : "–í–∏–∫–ª—é—á–∏—Ç–∏ –∑ —Ä–∞–Ω–¥–æ–º–∞";

      // –Ø–∫—â–æ —Å—Ç—Ä–∞–≤–∞ –º–∞—î –≤–ª–∞—Å–Ω–µ –º–µ–Ω—é (hasMenu === true), –ø–æ–∫–∞–∑–∞—Ç–∏ –∫–Ω–æ–ø–∫—É
      const menuBtn = document.getElementById("modalMenuBtn");
      if (dish.hasMenu) {
        menuBtn.style.display = "inline-flex";
      } else {
        menuBtn.style.display = "none";
      }

      document.getElementById("dishModalOverlay").style.display = "flex";
    }

    function closeDishModal() {
      document.getElementById("dishModalOverlay").style.display = "none";
      currentPickedDish = null;
    }

    function pickAnotherDish() {
      closeDishModal();
      filterAndPick();
    }

    function excludeCurrentDish() {
      if (!currentPickedDish) return;
      const name = currentPickedDish.name;
      if (excludedDishes.has(name)) {
        excludedDishes.delete(name);
      } else {
        excludedDishes.add(name);
      }
      closeDishModal();
      renderMenu();
    }

    function chooseOnlyDish() {
      if (!currentPickedDish) return;
      const name = currentPickedDish.name;
      closeDishModal();
      alert(`–í–∏ –æ–±—Ä–∞–ª–∏ —Å—Ç—Ä–∞–≤—É: ${name}`);
    }

    // –Ø–∫—â–æ —Å—Ç—Ä–∞–≤–∞ –º–∞—î –º–µ–Ω—é (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –±—É—Ä–≥–µ—Ä–∏), –≤—ñ–¥–∫—Ä–∏–≤–∞—î–º–æ –±—ñ–ª–¥–µ—Ä
    function chooseMenu() {
      if (!currentPickedDish) return;
      closeDishModal();
      openMenuBuilder(currentPickedDish);
    }

    // --- –ë—ñ–ª–¥–µ—Ä –º–µ–Ω—é (—Ç—ñ–ª—å–∫–∏ –¥–ª—è ¬´burgers¬ª) ---
    function openMenuBuilder(prefilledDish = null) {
      selectedCategory = 'burgers'; // –ø–µ—Ä–µ–∫–æ–Ω–∞—î–º–æ—Å—å, —â–æ –≤ –±—ñ–ª–¥–µ—Ä—ñ –ø—Ä–∞—Ü—é—î–º–æ –∑ –±—É—Ä“ë–µ—Ä–∞–º–∏
      document.getElementById("menuSection").style.display = "none";
      document.getElementById("menuBuilderSection").style.display = "block";
      // –û—á–∏—Å—Ç–∏—Ç–∏ —Å—Ç–∞–Ω –±—ñ–ª–¥–µ—Ä–∞
      builderSelection = { dish: null, sauce: null, drink: null, excludedBuilderDishes: new Set() };

      // –ù–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –≤–∫–ª–∞–¥–∫–∏
      document.getElementById('dishesTab').classList.add('active');
      document.getElementById('saucesTab').classList.remove('active');
      document.getElementById('drinksTab').classList.remove('active');

      if (prefilledDish) {
        builderSelection.dish = prefilledDish;
        renderFirstChoices(true);
        document.getElementById("toSaucesBtn").disabled = false;
      } else {
        renderFirstChoices(false);
        document.getElementById("toSaucesBtn").disabled = true;
      }
      renderSaucesList();
      renderDrinksList();
      document.getElementById("toDrinksBtn").disabled = true;
      document.getElementById("finishMenuBtn").disabled = true;
    }

    // --- –í–∫–ª–∞–¥–∫–∞ 1: –≤–∏–±—ñ—Ä —ñ–∑ —Ç—Ä—å–æ—Ö (–∞–±–æ –ø–µ—Ä–µ–¥–∑–∞–ø–æ–≤–Ω–µ–Ω–µ) + –≤–∏–∫–ª—é—á–µ–Ω–Ω—è + —Ä–∞–Ω–¥–æ–º ---
    function renderFirstChoices(prefilled = false) {
      const container = document.getElementById("firstChoices");
      container.innerHTML = '';
      if (prefilled && builderSelection.dish) {
        // –ü–æ–∫–∞–∑–∞—Ç–∏ –ª–∏—à–µ –≤–∂–µ –æ–±—Ä–∞–Ω—É —Å—Ç—Ä–∞–≤—É
        const d = builderSelection.dish;
        const div = document.createElement("div");
        div.className = "item";
        const imgSrc = d.img || "https://via.placeholder.com/60";
        div.innerHTML = `
          <div class="item-info">
            <img src="${imgSrc}" alt="${d.name}">
            <div class="item-details">
              <strong>${d.name}</strong>
            </div>
          </div>
          <button class="btn-danger" onclick="toggleExcludeBuilderDish('${d.name}')">
            ${builderSelection.excludedBuilderDishes.has(d.name) ? "–í–∫–ª—é—á–∏—Ç–∏" : "–í–∏–∫–ª—é—á–∏—Ç–∏"}
          </button>
        `;
        container.appendChild(div);
        return;
      }
      firstChoices.forEach(choice => {
        const isExcluded = builderSelection.excludedBuilderDishes.has(choice.name);
        const isSelected = builderSelection.dish && builderSelection.dish.name === choice.name;
        const div = document.createElement("div");
        div.className = "item" + (isExcluded ? " disabled" : "");
        div.innerHTML = `
          <div class="item-info">
            <img src="${choice.img}" alt="${choice.name}">
            <div class="item-details">
              <strong>${choice.name}</strong>
            </div>
          </div>
          <div>
            <button class="btn" onclick="selectBuilderDish('${choice.name}')" ${isExcluded ? 'disabled' : ''}>
              ${isSelected ? "–û–±—Ä–∞–Ω–æ" : "–í–∏–±—Ä–∞—Ç–∏"}
            </button>
            <button class="btn-danger" onclick="toggleExcludeBuilderDish('${choice.name}')">
              ${isExcluded ? "–í–∫–ª—é—á–∏—Ç–∏" : "–í–∏–∫–ª—é—á–∏—Ç–∏"}
            </button>
          </div>
        `;
        container.appendChild(div);
      });
    }

    function selectBuilderDish(name) {
      if (builderSelection.excludedBuilderDishes.has(name)) return;
      // –£ –±—ñ–ª–¥–µ—Ä—ñ ¬´—Å—Ç—Ä–∞–≤–∏¬ª –º–∏ –¥–æ–ø—É—Å–∫–∞—î–º–æ —Ç—Ä–∏ –≤–∞—Ä—ñ–∞–Ω—Ç–∏ (–ø–µ—Ä—à—ñ –∑—ñ —Å–ø–∏—Å–∫—É firstChoices)
      builderSelection.dish = firstChoices.find(c => c.name === name);
      renderFirstChoices();
      document.getElementById("toSaucesBtn").disabled = false;
    }

    function toggleExcludeBuilderDish(name) {
      if (builderSelection.excludedBuilderDishes.has(name)) {
        builderSelection.excludedBuilderDishes.delete(name);
      } else {
        builderSelection.excludedBuilderDishes.add(name);
        if (builderSelection.dish && builderSelection.dish.name === name) {
          builderSelection.dish = null;
          document.getElementById("toSaucesBtn").disabled = true;
        }
      }
      renderFirstChoices();
    }

    function randomizeBuilderDish() {
      const choices = firstChoices.filter(c => !builderSelection.excludedBuilderDishes.has(c.name));
      if (choices.length === 0) {
        alert("–ù–µ–º–∞—î –¥–æ—Å—Ç—É–ø–Ω–∏—Ö –≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤ üòï");
        return;
      }
      const pick = choices[Math.floor(Math.random() * choices.length)];
      builderSelection.dish = pick;
      renderFirstChoices();
      document.getElementById("toSaucesBtn").disabled = false;
    }

    function toSauces() {
      if (!builderSelection.dish) return;
      document.getElementById('dishesTab').classList.remove('active');
      document.getElementById('saucesTab').classList.add('active');
      document.getElementById('drinksTab').classList.remove('active');
    }

    // --- –í–∫–ª–∞–¥–∫–∞ 2: –°–æ—É—Å–∏ ---
    function renderSaucesList() {
      const container = document.getElementById("saucesList");
      container.innerHTML = '';
      sauces.forEach(s => {
        const isSelected = builderSelection.sauce && builderSelection.sauce.name === s.name;
        const div = document.createElement("div");
        div.className = "item";
        div.innerHTML = `
          <div class="item-info">
            <div class="item-details">
              <strong>${s.name}</strong>
            </div>
          </div>
          <button class="btn" onclick="selectBuilderSauce('${s.name}')">
            ${isSelected ? "–û–±—Ä–∞–Ω–æ" : "–í–∏–±—Ä–∞—Ç–∏"}
          </button>
        `;
        container.appendChild(div);
      });
    }

    function selectBuilderSauce(name) {
      builderSelection.sauce = sauces.find(s => s.name === name);
      renderSaucesList();
      document.getElementById("toDrinksBtn").disabled = false;
    }

    function randomizeBuilderSauce() {
      const pick = sauces[Math.floor(Math.random() * sauces.length)];
      builderSelection.sauce = pick;
      renderSaucesList();
      document.getElementById("toDrinksBtn").disabled = false;
    }

    function backToDishes() {
      document.getElementById('saucesTab').classList.remove('active');
      document.getElementById('dishesTab').classList.add('active');
      document.getElementById('drinksTab').classList.remove('active');
    }

    function toDrinks() {
      if (!builderSelection.sauce) return;
      document.getElementById('saucesTab').classList.remove('active');
      document.getElementById('drinksTab').classList.add('active');
      document.getElementById('dishesTab').classList.remove('active');
    }

    // --- –í–∫–ª–∞–¥–∫–∞ 3: –ù–∞–ø–æ—ó ---
    function renderDrinksList() {
      const container = document.getElementById("drinksList");
      container.innerHTML = '';
      drinksForBuilder.forEach(d => {
        const isSelected = builderSelection.drink && builderSelection.drink.name === d.name;
        const div = document.createElement("div");
        div.className = "item";
        div.innerHTML = `
          <div class="item-info">
            <img src="${d.img}" alt="${d.name}">
            <div class="item-details">
              <strong>${d.name}</strong>
            </div>
          </div>
          <button class="btn" onclick="selectBuilderDrink('${d.name}')">
            ${isSelected ? "–û–±—Ä–∞–Ω–æ" : "–í–∏–±—Ä–∞—Ç–∏"}
          </button>
        `;
        container.appendChild(div);
      });
    }

    function selectBuilderDrink(name) {
      builderSelection.drink = drinksForBuilder.find(d => d.name === name);
      renderDrinksList();
      document.getElementById("finishMenuBtn").disabled = false;
    }

    function randomizeBuilderDrink() {
      const pick = drinksForBuilder[Math.floor(Math.random() * drinksForBuilder.length)];
      builderSelection.drink = pick;
      renderDrinksList();
      document.getElementById("finishMenuBtn").disabled = false;
    }

    function backToSauces() {
      document.getElementById('drinksTab').classList.remove('active');
      document.getElementById('saucesTab').classList.add('active');
      document.getElementById('dishesTab').classList.remove('active');
    }

    function finishMenu() {
      const dishName = builderSelection.dish.name;
      const sauceName = builderSelection.sauce.name;
      const drinkName = builderSelection.drink.name;
      alert(`–í–∞—à–µ –º–µ–Ω—é:\n\n–°—Ç—Ä–∞–≤–∞: ${dishName}\n–°–æ—É—Å: ${sauceName}\n–ù–∞–ø—ñ–π: ${drinkName}`);
      document.getElementById("menuBuilderSection").style.display = "none";
      document.getElementById("menuSection").style.display = "block";
      renderMenu();
    }

    // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î–º–æ –±—ñ–ª–¥–µ—Ä, –ø—Ä–∏—Ö–æ–≤–∞–≤—à–∏ –≤–∫–ª–∞–¥–∫–∏ –æ–∫—Ä—ñ–º –ø–µ—Ä—à–æ—ó
    function initFirstChoices() {
      renderFirstChoices(false);
      document.getElementById('dishesTab').classList.add('active');
      document.getElementById('saucesTab').classList.remove('active');
      document.getElementById('drinksTab').classList.remove('active');
    }
    initFirstChoices();
  </script>
</body>
</html>
